Please review the code that has been modified since the last commit and see if there's any common code that can be extracted so as to make the code more readible and less repetitive
